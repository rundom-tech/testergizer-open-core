# Testergizer Open Core

Open-core engine for Testergizer: JSON test definitions, runner, assertions, CLI, and basic analysis tools.

## Install

```bash
npm install
npx playwright install
```

## Build

```bash
npm run build
```

## Link CLI (development)

```bash
npm link
```

## JSON schemas (v1)

- `schemas/test-suite.v1.json` — test plan (suite)
- `schemas/results.v1.json` — execution output (results)

### Versioning

Suites may include a `version` field. If omitted, the runner assumes `"1.0"`.

## Step IDs (traceability)

Add a stable `id` per step in your suite JSON:

```json
{
  "id": "login-button-value",
  "action": "assert",
  "assert": "valueContains",
  "selector": "#login-button",
  "value": "Login"
}
```

If `id` is omitted, the runner emits fallback IDs: `step-1`, `step-2`, ...

## Run

```bash
testergizer run tests/login.saucedemo.json --headed
testergizer run tests/login.saucedemo.json --headed --slow-mo 200
testergizer run tests/login.saucedemo.json --browser firefox
testergizer run tests/login.saucedemo.json --screenshot-on-fail
```

## Step retries (keyed by step ID)

Retry all steps up to 2 times:

```bash
testergizer run tests/login.saucedemo.json --step-retries 2
```

Retry only selected steps:

```bash
testergizer run tests/login.saucedemo.json --step-retries 2 --retry-steps login-button-value,username-placeholder
```

Optional delay between attempts:

```bash
testergizer run tests/login.saucedemo.json --step-retries 2 --retry-delay-ms 200
```

When a step passes after retries, the results report marks it as:

- `"attempts": >1`
- `"flaky": true`

## Artifacts

- `artifacts/results.json`
- `artifacts/*-failure.png` (when `--screenshot-on-fail` is enabled)

## Diff two runs (by test/step IDs)

```bash
testergizer diff artifacts/results.json artifacts/results.prev.json --out artifacts/diff.json
```

## Flaky detection across many runs

```bash
testergizer flaky artifacts/ --out artifacts/flaky.json
```

A test/step is considered **flaky** if it has at least one pass and one fail across the provided runs.
